import{u as K,j as d,R as O,b as A,f as Q,r as l,g as Y,aV as J}from"./index-CcP3vPZw.js";import{g as X,aq as Z,ar as S,w as tt,as as et,at as nt,au as ot,B as st,av as rt}from"./index-BJyBPkbd.js";import{u as at}from"./useCSSKeyframesAnimationController-1tmins_p.js";const ct="_body_fjiy3_1",ut="_sizeYRegular_fjiy3_21",it="_sizeYNone_fjiy3_33",lt="_modeDark_fjiy3_45",dt="_before_fjiy3_49",_t="_after_fjiy3_54",ft="_content_fjiy3_59",mt="_contentText_fjiy3_65",yt="_contentSubtitle_fjiy3_75",pt="_layoutHorizontal_fjiy3_87",ht="_action_fjiy3_87",xt="_layoutVertical_fjiy3_93",Et="_layoutNone_fjiy3_107",u={body:ct,sizeYRegular:ut,sizeYNone:it,modeDark:lt,before:dt,after:_t,content:ft,contentText:mt,contentSubtitle:yt,layoutHorizontal:pt,action:ht,layoutVertical:xt,layoutNone:Et},bt={none:u.layoutNone,vertical:u.layoutVertical,horizontal:u.layoutHorizontal},gt={none:u.sizeYNone,regular:u.sizeYRegular};function G({layout:n,action:e,after:t,before:o,mode:a,subtitle:r,children:x,...p}){const{sizeY:E="none"}=K(),b=t||r?"vertical":"none";return d.jsxs(O,{...p,baseClassName:A(u.body,bt[n||b],E!=="compact"&&gt[E],a==="dark"&&u.modeDark),children:[o&&d.jsx("div",{className:u.before,children:o}),d.jsxs("div",{className:u.content,children:[d.jsx(X,{className:u.contentText,children:x}),r&&!e&&d.jsx(Z,{className:u.contentSubtitle,children:r}),e&&!r&&d.jsx("div",{className:u.action,children:e})]}),t&&d.jsx("div",{className:u.after,children:t})]})}function Tt(n,e){if(e!==void 0)switch(n){case"top-start":case"top":case"top-end":return{top:e};case"bottom-start":case"bottom":case"bottom-end":return{bottom:e}}}function zt(n,e,t){return{shifted:!1,direction:null,isDesktop:t.smallTabletPlus.matches,x:0,y:0,width:n,height:e}}function St(n,e,t){if(e.isDesktop)n.endsWith("start")?e.x=S(t.x,-e.width,0):n.endsWith("end")&&(e.x=S(t.x,0,e.width)),n.startsWith("bottom")&&(e.y=S(t.y,0,e.height));else if(n.startsWith("bottom")){e.x=t.x;const o=t.x<0?-1:null,a=t.x>0?1:null;e.direction=o||a}return n.startsWith("top")&&(e.y=S(t.y,-e.height,0)),e.shifted=!0,e}const N=200;function jt(n,e,t,o){if(!e.shifted)return!1;const a={x:!1,y:!1},r={x:!1,y:!1};return e.isDesktop?(n.endsWith("start")?(a.x=t.x<-t.width/2,r.x=t.x<0?o.x<-200:!1):n.endsWith("end")&&(a.x=t.x>t.width/2,r.x=t.x>0?o.x>N:!1),n.startsWith("bottom")&&(a.y=t.y>t.height/2,r.y=t.y>0?o.y>N:!1)):n.startsWith("bottom")&&(a.x=t.x<-t.width/2||t.x>t.width/2,r.x=t.x<0&&o.x<-200||t.x>0&&o.x>N),n.startsWith("top")&&(a.y=t.y<-t.height/2,r.y=t.y<0?o.y<-200:!1),a.x||r.x||a.y||r.y}const kt="_host_n1z7r_1",Bt="_ios_n1z7r_20",Nt="_placementTopStart_n1z7r_24",Rt="_placementTop_n1z7r_24",vt="_placementTopEnd_n1z7r_26",Mt="_placementBottomStart_n1z7r_33",Pt="_placementBottomEnd_n1z7r_37",Wt="_placementBottom_n1z7r_33",wt="_stateEnter_n1z7r_137",It="_stateEntering_n1z7r_138",Yt="_stateEntered_n1z7r_149",Ot="_touched_n1z7r_155",At="_stateExit_n1z7r_159",Gt="_stateExiting_n1z7r_160",s={host:kt,ios:Bt,placementTopStart:Nt,placementTop:Rt,placementTopEnd:vt,placementBottomStart:Mt,placementBottomEnd:Pt,placementBottom:Wt,in:"_in_n1z7r_101",stateEnter:wt,stateEntering:It,stateEntered:Yt,touched:Ot,stateExit:At,stateExiting:Gt},Ht={"top-start":s.placementTopStart,top:s.placementTop,"top-end":s.placementTopEnd,"bottom-start":s.placementBottomStart,bottom:s.placementBottom,"bottom-end":s.placementBottomEnd},Ut={enter:s.stateEnter,entering:s.stateEntering,entered:s.stateEntered,exit:s.stateExit,exiting:s.stateExiting,exited:void 0},Vt=({placement:n="bottom-start",children:e,layout:t,action:o,before:a,after:r,duration:x=4e3,onActionClick:p,onClose:E,mode:b="default",subtitle:H,offsetY:U,getRootRef:V,...F})=>{const L=Q(),[m,$]=l.useState(!0),[y,R]=l.useState(!1),c=tt(V),v=et(c),M=l.useRef(null),f=l.useRef(null),i=l.useRef(null),g=l.useRef(null),P=l.useRef(void 0),D=nt(),[T,q]=at(m?"enter":"exit",{onExited:E}),z=l.useCallback(()=>{g.current!==null&&(cancelAnimationFrame(g.current),g.current=null)},[]),j=l.useCallback((_,B,I)=>{g.current=requestAnimationFrame(()=>{c.current&&(_===null?c.current.style.removeProperty("--vkui_internal--snackbar_shift_x"):c.current.style.setProperty("--vkui_internal--snackbar_shift_x",`${_}px`),B===null?c.current.style.removeProperty("--vkui_internal--snackbar_shift_y"):c.current.style.setProperty("--vkui_internal--snackbar_shift_y",`${B}px`),I===null?c.current.style.removeProperty("--vkui_internal--snackbar_direction"):c.current.style.setProperty("--vkui_internal--snackbar_direction",`${I}`))})},[c]),h=l.useCallback(()=>{$(!1)},[]),C=_=>{h(),o&&(p==null||p(_))},W=_=>{f.current=new rt,f.current.setStartCoords(_.nativeEvent),i.current=zt(c.current.offsetWidth,c.current.offsetHeight,D),R(!0)},w=_=>{i.current&&f.current&&(f.current.setInitialTimeOnce(),f.current.setEndCoords(_.nativeEvent),i.current=St(n,i.current,f.current.delta()),i.current.shifted&&j(i.current.x,i.current.y,i.current.direction))},k=()=>{y&&i.current&&f.current&&jt(n,i.current,J(c.current,M.current),f.current.velocity())&&h(),R(!1)};return Y(function(){if(!(!m||v||y||T!=="entered"))return P.current=setTimeout(h,x),function(){clearTimeout(P.current)}},[m,v,y,T,h,x]),Y(function(){y||(z(),i.current=null,f.current=null,m&&j(null,null,null))},[y,m,j,z]),l.useEffect(()=>z,[z]),ot(m,h),T==="exited"?null:d.jsx(O,{...F,role:"presentation",baseClassName:A(s.host,L==="ios"&&s.ios,y&&s.touched,Ht[n],Ut[T]),baseStyle:Tt(n,U),getRootRef:c,children:d.jsx("div",{role:"alert",className:s.in,ref:M,onTouchStart:W,onTouchMove:w,onTouchEnd:k,onMouseDown:W,onMouseMove:w,onMouseUp:k,onMouseLeave:k,...q,children:d.jsx(G,{mode:b,layout:t,before:a,after:r,subtitle:H,action:o&&d.jsx(st,{align:"left",mode:"link",appearance:b==="dark"?"overlay":"accent",size:"s",onClick:C,children:o}),children:e})})})};Vt.Basic=G;export{Vt as S};
