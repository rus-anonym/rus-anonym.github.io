import{m as z,j as t,b,V as it,f as C,r as c,ah as ct,n as q,v as F,aQ as lt,ax as dt,as as ut,aR as pt,aG as mt,aH as V,aI as T}from"./index-qVLION_7.js";import{Y as ht,Z as et,f as xt,B as P,_ as Y,$ as ft,E as _t,u as jt,a0 as gt,I as vt,a as yt,G as y,Q,e as W,H as N,a1 as bt,i as At,s as Z,R as Ct}from"./index-BPTW7plB.js";import{u as kt}from"./useCSSKeyframesAnimationController-pXvxBL7y.js";import{C as St,a as wt}from"./CardScroll-CQCa42yo.js";import{P as Mt}from"./Progress-CqPfNg7h.js";import{M as B}from"./MiniInfoCell-DWjLvwLC.js";import{h as Dt}from"./moment-C5S46NFB.js";var G=z("Icon28ErrorCircleOutline","error_circle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="error_circle_outline_28"><path fill="currentColor" d="M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 2C8.477 4 4 8.477 4 14s4.477 10 10 10 10-4.477 10-10S19.523 4 14 4m0 13.6a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8m.074-9.6c.237 0 .386.037.517.107q.196.106.302.302c.07.13.107.28.107.517v6.148c0 .237-.037.386-.107.517a.73.73 0 0 1-.302.302c-.13.07-.28.107-.517.107h-.148c-.237 0-.386-.037-.517-.107a.73.73 0 0 1-.302-.302c-.07-.13-.107-.28-.107-.517V8.926c0-.237.037-.386.107-.517a.73.73 0 0 1 .302-.302c.13-.07.28-.107.517-.107z" /></symbol>',28,28),J=z("Icon28SpeedometerMaxOutline","speedometer_max_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="speedometer_max_outline_28"><path fill="currentColor" d="M14 2c1.687 0 3.294.348 4.751.978l.328.147a12 12 0 0 1 3.406 2.39A11.97 11.97 0 0 1 26 14q0 .638-.065 1.26a1 1 0 0 1-1.99-.208Q24 14.534 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.112-2.115l-.005-.002A10 10 0 0 0 14 4a9.96 9.96 0 0 0-4.7 1.17l-.066.036A10 10 0 0 0 6.93 6.93 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.74-2.54l.006-.002A12 12 0 0 1 14 2" /><path fill="currentColor" fill-rule="evenodd" d="m16.077 11.8 8.905 7.247c1 .813.084 2.4-1.12 1.94L13.131 16.9a3 3 0 0 1-.318-.143 3 3 0 1 1 2.979-5.162q.146.093.284.205M14.5 13.133a1 1 0 1 0-1 1.732 1 1 0 0 0 1-1.732" clip-rule="evenodd" /></symbol>',28,28),K=z("Icon28SpeedometerMiddleOutline","speedometer_middle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="speedometer_middle_outline_28"><path fill-rule="evenodd" d="M16.944 13.302 15.121 1.966c-.205-1.273-2.037-1.273-2.242 0l-1.823 11.336a3 3 0 0 0-.036.347 3 3 0 1 0 5.96.001 3 3 0 0 0-.036-.348M15 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd" /><path d="M17.431 3.498a1 1 0 0 1 1.314-.523 12 12 0 0 1 3.74 2.54A11.97 11.97 0 0 1 26 14c0 2.413-.713 4.663-1.941 6.546a1 1 0 1 1-1.676-1.092A9.95 9.95 0 0 0 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.117-2.117 1 1 0 0 1-.523-1.314m-6.868.002a1 1 0 0 1-.522 1.314A10 10 0 0 0 6.93 6.929 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.734-2.537 1 1 0 0 1 1.314.521Z" /></symbol>',28,28),U=z("Icon28SpeedometerStartOutline","speedometer_start_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="speedometer_start_outline_28"><path d="M14 2c-1.687 0-3.293.348-4.751.978l-.328.147a12 12 0 0 0-3.406 2.39A11.97 11.97 0 0 0 2 14q0 .638.065 1.26a1 1 0 0 0 1.99-.208A10 10 0 0 1 4 14a9.97 9.97 0 0 1 2.929-7.071 10 10 0 0 1 3.112-2.115l.005-.002A10 10 0 0 1 14 4a9.96 9.96 0 0 1 4.7 1.17l.066.036c.85.462 1.626 1.044 2.305 1.723A9.97 9.97 0 0 1 24 14a9.95 9.95 0 0 1-1.617 5.454 1 1 0 1 0 1.676 1.092A11.95 11.95 0 0 0 26 14c0-3.313-1.344-6.315-3.515-8.485a12 12 0 0 0-3.74-2.54l-.006-.002A12 12 0 0 0 14 2" /><path fill-rule="evenodd" d="m11.923 11.8-8.905 7.247c-1 .813-.084 2.4 1.12 1.94l10.73-4.088q.165-.063.318-.143a3 3 0 1 0-2.979-5.162q-.146.093-.284.205Zm1.577 1.334a1 1 0 1 1 1 1.732 1 1 0 0 1-1-1.732" clip-rule="evenodd" /></symbol>',28,28);const It="_host_sxbvb_1",Rt={host:It},Ht=({children:e="Закрыть",className:s,...a})=>t.jsxs(ht,{className:b(Rt.host,s),...a,children:[e&&t.jsx(it,{children:e}),t.jsx(et,{})]}),$t="_host_18anj_1",Lt="_desktop_18anj_17",Nt="_opening_18anj_21",Bt="_closing_18anj_26",zt="_content_18anj_43",Et="_contentWithButton_18anj_49",Wt="_action_18anj_54",Ot="_actions_18anj_59",Vt="_title_18anj_67",Pt="_description_18anj_72",qt="_actionsDirectionHorizontal_18anj_81",Ft="_actionsDirectionVertical_18anj_85",Tt="_actionsAlignLeft_18anj_96",Yt="_actionsAlignCenter_18anj_101",Qt="_actionsAlignRight_18anj_106",Zt="_ios_18anj_115",Gt="_actionModeCancel_18anj_254",Jt="_actionModeDestructive_18anj_258",Kt="_vkcom_18anj_266",Ut="_button_18anj_283",Xt="_buttonModeCancel_18anj_287",te="_dismiss_18anj_291",o={host:$t,desktop:Lt,opening:Nt,closing:Bt,content:zt,contentWithButton:Et,action:Wt,actions:Ot,title:Vt,description:Pt,actionsDirectionHorizontal:qt,actionsDirectionVertical:Ft,actionsAlignLeft:Tt,actionsAlignCenter:Yt,actionsAlignRight:Qt,ios:Zt,actionModeCancel:Gt,actionModeDestructive:Jt,vkcom:Kt,button:Ut,buttonModeCancel:Xt,dismiss:te},ee=({mode:e,...s})=>t.jsx(xt,{Component:s.href?"a":"button",baseClassName:b(o.action,e==="destructive"&&o.actionModeDestructive,e==="cancel"&&o.actionModeCancel),...s}),se=({mode:e,...s})=>{const a=C();let i="tertiary";return a==="vkcom"&&(i=e==="cancel"?"secondary":"primary"),t.jsx(P,{className:b(o.button,e==="cancel"&&o.buttonModeCancel),mode:i,size:"m",...s})},oe=e=>C()==="ios"?t.jsx(ee,{...e}):t.jsx(se,{...e}),ne={left:o.actionsAlignLeft,center:o.actionsAlignCenter,right:o.actionsAlignRight},re={vertical:o.actionsDirectionVertical,horizontal:o.actionsDirectionHorizontal},ae=({actions:e=[],renderAction:s=x=>t.jsx(oe,{...x}),onItemClick:a,actionsAlign:i,actionsLayout:l})=>{const m=C()==="vkcom"?"horizontal":l;return t.jsx("div",{className:b(o.actions,i&&ne[i],m&&re[m]),children:e.map((f,A)=>{const{title:j,action:d,autoCloseDisabled:g,...r}=f;return t.jsx(c.Fragment,{children:s({children:j,onClick:()=>a(f),...r})},A)})})},ie=e=>{switch(C()){case"ios":return t.jsx(Y,{className:o.title,weight:"1",level:"3",...e});default:return t.jsx(Y,{className:o.title,weight:"2",level:"2",...e})}},ce=e=>{switch(C()){case"vkcom":return t.jsx(ct,{className:o.description,...e});case"ios":return t.jsx(_t,{className:o.description,...e});default:return t.jsx(ft,{Component:"span",className:o.description,weight:"3",...e})}},le=({actions:e,actionsLayout:s="horizontal",children:a,title:i,description:l,onClose:x,dismissLabel:m="Закрыть предупреждение",renderAction:f,actionsAlign:A,dismissButtonMode:j="outside",dismissButtonTestId:d,onClick:g,allowClickPropagation:r=!1,titleTestId:E,descriptionTestId:k,closing:u,setClosing:p,...S})=>{const w=c.useId(),R=`vkui-alert-${w}-title`,M=`vkui-alert-${w}-description`,n=C(),{isDesktop:_}=jt(),v=c.useRef(q),[H,h]=kt(u?"exit":"enter",{onExited(){v.current(),v.current=q,x()}}),D=_&&n!=="ios",ot=c.useRef(null),I=c.useCallback(()=>{p==null||p(!0)},[p]),nt=c.useCallback($=>{const{action:L,autoCloseDisabled:at=!1}=$;at?L&&L({close:I}):(L&&(v.current=L),p==null||p(!0))},[I,p]),rt=r?g:$=>{lt($),g==null||g($)};return t.jsxs(gt,{...h,onClick:rt,getRootRef:ot,onClose:I,autoFocus:H==="entered",className:b(o.host,n==="ios"&&o.ios,n==="vkcom"&&o.vkcom,u?o.closing:o.opening,_&&o.desktop),role:"alertdialog","aria-modal":!0,"aria-labelledby":R,"aria-describedby":M,...S,children:[t.jsxs("div",{className:b(o.content,j==="inside"&&o.contentWithButton),children:[F(i)&&t.jsx(ie,{"data-testid":E,id:R,children:i}),F(l)&&t.jsx(ce,{"data-testid":k,id:M,children:l}),a,D&&j==="inside"&&t.jsx(vt,{label:m,className:b(o.dismiss,"vkuiInternalAlert__dismiss"),onClick:I,hoverMode:"opacity",activeMode:"opacity","data-testid":d,children:t.jsx(et,{})})]}),D&&j==="outside"&&t.jsx(Ht,{onClick:I,"data-testid":d,children:m}),t.jsx(ae,{actions:e,actionsAlign:A,actionsLayout:s,renderAction:f,onItemClick:nt})]})},de=({usePortal:e,style:s,className:a,getRootRef:i,...l})=>{const[x,m]=c.useState(!1),f=c.useCallback(()=>{m(!0)},[]);return dt(),t.jsx(ut,{usePortal:e,children:t.jsx(pt,{className:a,closing:x,style:s,onClick:f,getRootRef:i,strategy:"fixed",children:t.jsx(le,{...l,closing:x,setClosing:m})})})},ue={light:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"black"}},dark:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"white"}}},pe=({value:e,status:s})=>t.jsx("span",{style:ue[V.theme][s],children:e}),X=e=>{const s=e.split("").map(a=>({value:a,status:"default"}));return s[0].status="current",s},me={ru:/^[ЁёА-я\s]/,en:/^[a-zA-Z\s]/},st=(e,s)=>e.date<s.date?1:-1,tt=(e,s)=>{const[a,i]=[e.cpm/e.errors,s.cpm/s.errors];return a>i?-1:a<i?1:e.cpm>s.cpm?-1:e.cpm<s.cpm?1:0};class O{static load(){return Z.utils.storage.speedtype.history.slice()}static save(s){s.length>100&&(s.sort(st),s=s.slice(0,100)),Z.utils.storage.speedtype.history=s}}const he=()=>{const[e,s]=c.useState(),[a,i]=c.useState(0),[l,x]=c.useState(0),[m,f]=c.useState(0),[A,j]=c.useState(!1),[d,g]=c.useState(O.load()),{t:r,i18n:E}=yt("translation",{keyPrefix:"pages.utils.list.speedtype"}),k=r("text"),[u,p]=c.useState(X(k)),S=n=>t.jsx(wt,{mode:"outline",style:{textAlign:"center"},children:t.jsxs(Ct,{hasActive:!1,hasHover:!1,subtitle:E.t(`languages.${n.lang}`),extraSubtitle:Dt(n.date).format("DD.MM.YYYY, HH:mm:ss"),children:[t.jsxs(B,{before:n.cpm<200?t.jsx(U,{}):n.cpm<400?t.jsx(K,{}):t.jsx(J,{}),textWrap:"short",children:[r("cpm"),": ",n.cpm]}),t.jsxs(B,{before:t.jsx(G,{fill:`rgb(${150+n.errors}, ${162-n.errors*8.1}, ${173-n.errors*8.65})`}),textWrap:"short",children:[r("errors"),": ",n.errors]})]})}),w=()=>{i(0),x(0),f(0),p(X(k))},R=n=>{if(!me[V.language].test(n)){T.popout=t.jsx(de,{actions:[{title:r("continue"),mode:"default"}],description:r("switchLayout"),onClose:()=>{T.popout=null}});return}const _=u.findIndex(h=>h.status==="current"||h.status==="invalid"),v=u[_];_===0&&v.status==="current"&&s(Date.now());debugger;const H=()=>{let h=Math.floor(60/((Date.now()-e)/1e3/_));return isNaN(h)&&(h=0),h};if(n===v.value)if(v.status="valid",_+1===u.length){p([]),f(_/(u.length/100));const h=H();i(h);const D=[...d,{lang:V.language,cpm:h,errors:l,date:e}];g(D),O.save(D),j(!1);return}else u[_+1].status="current";else v.status="invalid",x(l+1);f(_/(u.length/100)),i(H()),p([...u])},M=n=>{n.preventDefault(),(A||n.key===k[0])&&(j(!0),R(n.key))};return c.useEffect(()=>(document.addEventListener("keypress",M),()=>{document.removeEventListener("keypress",M)}),[a,e,l,d,m,A]),t.jsxs(y,{children:[u.length>0&&t.jsxs(Q,{onClick:()=>{var n;(n=document.getElementById("input"))==null||n.focus()},children:[t.jsx(Mt,{value:m}),t.jsx(W,{size:28}),t.jsx("div",{style:{textAlign:"center"},children:u.map(pe)})]}),t.jsxs(y,{mode:"plain",header:t.jsx(N,{children:r("results")}),children:[t.jsxs(B,{before:a<200?t.jsx(U,{}):a<400?t.jsx(K,{}):t.jsx(J,{}),textWrap:"short",children:[r("cpm"),": ",a]}),t.jsxs(B,{before:t.jsx(G,{fill:`rgb(${150+l}, ${162-l*8.1}, ${173-l*8.65})`}),textWrap:"short",children:[r("errors"),": ",l]}),u.length===0&&t.jsx(Q,{style:{display:"flex",justifyContent:"center"},children:t.jsx(P,{appearance:"positive",stretched:!0,size:"l",onClick:w,children:r("restart")})})]}),d.length>0&&t.jsxs(y,{mode:"plain",children:[t.jsx(y,{separator:"hide",mode:"plain",style:{textAlign:"center"},description:`${r("formula")}: ${r("cpm")} / ${r("errors")}`,children:t.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"center"},children:[t.jsxs(y,{style:{marginRight:d.length>1?"5px":void 0},separator:"hide",mode:"plain",children:[t.jsx(N,{children:r("bestResult")}),S(d.sort(tt)[0])]}),d.length>1&&t.jsxs(y,{style:{marginLeft:"5px"},separator:"hide",mode:"plain",children:[t.jsx(N,{children:r("worstResult")}),S(d.sort(tt)[d.length-1])]})]})}),t.jsx(W,{}),t.jsx(y,{mode:"plain",header:t.jsx(N,{after:`${r("total")}: ${d.length}`,children:r("history")}),children:t.jsx(St,{padding:!0,children:d.sort(st).map(S)})}),t.jsx(W,{}),t.jsx(bt,{}),t.jsx(At,{hasActive:!1,hasHover:!1,children:t.jsx(P,{size:"m",mode:"primary",appearance:"negative",onClick:()=>{g([]),O.save([]),w()},children:r("clearHistory")})})]})]})},be=mt(he);export{be as default};
