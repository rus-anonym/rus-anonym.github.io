import{m as z,f as w,j as t,b as k,r as i,ag as rt,n as V,aw as at,ar as it,aQ as ct,aR as lt,w as q,aG as dt,aH as O,aI as F}from"./index-AWcCmRSM.js";import{f as ut,B as P,X as T,Y as pt,z as mt,u as gt,Z as ht,c as xt,_ as _t,$ as ft,a as vt,G as j,O as Y,e as W,H as L,a0 as jt,i as Ct,s as Z,R as yt}from"./index-BGqKRUTb.js";import{u as bt}from"./useCSSKeyframesAnimationController-BThv-rPy.js";import{C as At,a as kt}from"./CardScroll-BSsnqtvA.js";import{P as wt}from"./Progress-Dy7slxZp.js";import{M as N}from"./MiniInfoCell-UxbOKLgK.js";import{h as St}from"./moment-C5S46NFB.js";var G=z("Icon28ErrorCircleOutline","error_circle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="error_circle_outline_28"><path fill="currentColor" d="M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 2C8.477 4 4 8.477 4 14s4.477 10 10 10 10-4.477 10-10S19.523 4 14 4m0 13.6a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8m.074-9.6c.237 0 .386.037.517.107q.196.106.302.302c.07.13.107.28.107.517v6.148c0 .237-.037.386-.107.517a.73.73 0 0 1-.302.302c-.13.07-.28.107-.517.107h-.148c-.237 0-.386-.037-.517-.107a.73.73 0 0 1-.302-.302c-.07-.13-.107-.28-.107-.517V8.926c0-.237.037-.386.107-.517a.73.73 0 0 1 .302-.302c.13-.07.28-.107.517-.107z" /></symbol>',28,28),Q=z("Icon28SpeedometerMaxOutline","speedometer_max_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="speedometer_max_outline_28"><path fill="currentColor" d="M14 2c1.687 0 3.294.348 4.751.978l.328.147a12 12 0 0 1 3.406 2.39A11.97 11.97 0 0 1 26 14q0 .638-.065 1.26a1 1 0 0 1-1.99-.208Q24 14.534 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.112-2.115l-.005-.002A10 10 0 0 0 14 4a9.96 9.96 0 0 0-4.7 1.17l-.066.036A10 10 0 0 0 6.93 6.93 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.74-2.54l.006-.002A12 12 0 0 1 14 2" /><path fill="currentColor" fill-rule="evenodd" d="m16.077 11.8 8.905 7.247c1 .813.084 2.4-1.12 1.94L13.131 16.9a3 3 0 0 1-.318-.143 3 3 0 1 1 2.979-5.162q.146.093.284.205M14.5 13.133a1 1 0 1 0-1 1.732 1 1 0 0 0 1-1.732" clip-rule="evenodd" /></symbol>',28,28),J=z("Icon28SpeedometerMiddleOutline","speedometer_middle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="speedometer_middle_outline_28"><path fill-rule="evenodd" d="M16.944 13.302 15.121 1.966c-.205-1.273-2.037-1.273-2.242 0l-1.823 11.336a3 3 0 0 0-.036.347 3 3 0 1 0 5.96.001 3 3 0 0 0-.036-.348M15 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd" /><path d="M17.431 3.498a1 1 0 0 1 1.314-.523 12 12 0 0 1 3.74 2.54A11.97 11.97 0 0 1 26 14c0 2.413-.713 4.663-1.941 6.546a1 1 0 1 1-1.676-1.092A9.95 9.95 0 0 0 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.117-2.117 1 1 0 0 1-.523-1.314m-6.868.002a1 1 0 0 1-.522 1.314A10 10 0 0 0 6.93 6.929 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.734-2.537 1 1 0 0 1 1.314.521Z" /></symbol>',28,28),K=z("Icon28SpeedometerStartOutline","speedometer_start_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="speedometer_start_outline_28"><path d="M14 2c-1.687 0-3.293.348-4.751.978l-.328.147a12 12 0 0 0-3.406 2.39A11.97 11.97 0 0 0 2 14q0 .638.065 1.26a1 1 0 0 0 1.99-.208A10 10 0 0 1 4 14a9.97 9.97 0 0 1 2.929-7.071 10 10 0 0 1 3.112-2.115l.005-.002A10 10 0 0 1 14 4a9.96 9.96 0 0 1 4.7 1.17l.066.036c.85.462 1.626 1.044 2.305 1.723A9.97 9.97 0 0 1 24 14a9.95 9.95 0 0 1-1.617 5.454 1 1 0 1 0 1.676 1.092A11.95 11.95 0 0 0 26 14c0-3.313-1.344-6.315-3.515-8.485a12 12 0 0 0-3.74-2.54l-.006-.002A12 12 0 0 0 14 2" /><path fill-rule="evenodd" d="m11.923 11.8-8.905 7.247c-1 .813-.084 2.4 1.12 1.94l10.73-4.088q.165-.063.318-.143a3 3 0 1 0-2.979-5.162q-.146.093-.284.205Zm1.577 1.334a1 1 0 1 1 1 1.732 1 1 0 0 1-1-1.732" clip-rule="evenodd" /></symbol>',28,28);const Mt="_host_18tpg_1",Dt="_desktop_18tpg_19",Rt="_opening_18tpg_23",It="_closing_18tpg_28",Ht="_content_18tpg_45",$t="_contentWithButton_18tpg_51",Lt="_action_18tpg_56",Nt="_actions_18tpg_61",zt="_title_18tpg_69",Bt="_description_18tpg_74",Wt="_actionsDirectionHorizontal_18tpg_83",Et="_actionsDirectionVertical_18tpg_87",Ot="_actionsAlignLeft_18tpg_98",Pt="_actionsAlignCenter_18tpg_103",Vt="_actionsAlignRight_18tpg_108",qt="_ios_18tpg_117",Ft="_actionModeCancel_18tpg_256",Tt="_actionModeDestructive_18tpg_260",Yt="_vkcom_18tpg_268",Zt="_button_18tpg_285",Gt="_buttonModeCancel_18tpg_289",Qt="_dismiss_18tpg_293",o={host:Mt,desktop:Dt,opening:Rt,"animation-alert-scale-up":"_animation-alert-scale-up_18tpg_1",closing:It,"animation-alert-scale-down":"_animation-alert-scale-down_18tpg_1",content:Ht,contentWithButton:$t,action:Lt,actions:Nt,title:zt,description:Bt,actionsDirectionHorizontal:Wt,actionsDirectionVertical:Et,actionsAlignLeft:Ot,actionsAlignCenter:Pt,actionsAlignRight:Vt,ios:qt,actionModeCancel:Ft,actionModeDestructive:Tt,vkcom:Yt,button:Zt,buttonModeCancel:Gt,dismiss:Qt},Jt=({mode:e,...s})=>t.jsx(ut,{Component:s.href?"a":"button",baseClassName:k(o.action,e==="destructive"&&o.actionModeDestructive,e==="cancel"&&o.actionModeCancel),...s}),Kt=({mode:e,...s})=>{const a=w();let c="tertiary";return a==="vkcom"&&(c=e==="cancel"?"secondary":"primary"),t.jsx(P,{className:k(o.button,e==="cancel"&&o.buttonModeCancel),mode:c,size:"m",...s})},Xt=e=>w()==="ios"?t.jsx(Jt,{...e}):t.jsx(Kt,{...e}),Ut={left:o.actionsAlignLeft,center:o.actionsAlignCenter,right:o.actionsAlignRight},te={vertical:o.actionsDirectionVertical,horizontal:o.actionsDirectionHorizontal},ee=({actions:e=[],renderAction:s=g=>t.jsx(Xt,{...g}),onItemClick:a,actionsAlign:c,actionsLayout:u})=>{const h=w()==="vkcom"?"horizontal":u;return t.jsx("div",{className:k(o.actions,c&&Ut[c],h&&te[h]),children:e.map((x,f)=>{const{title:C,action:l,autoCloseDisabled:v,...r}=x;return t.jsx(i.Fragment,{children:s({children:C,onClick:()=>a(x),...r})},f)})})},se=e=>{switch(w()){case"ios":return t.jsx(T,{className:o.title,weight:"1",level:"3",...e});default:return t.jsx(T,{className:o.title,weight:"2",level:"2",...e})}},oe=e=>{switch(w()){case"vkcom":return t.jsx(rt,{className:o.description,...e});case"ios":return t.jsx(mt,{className:o.description,...e});default:return t.jsx(pt,{Component:"span",className:o.description,weight:"3",...e})}},ne=({actions:e,actionsLayout:s="horizontal",children:a,className:c,style:u,title:g,description:h,onClose:x,dismissLabel:f="Закрыть предупреждение",renderAction:C,actionsAlign:l,dismissButtonMode:v="outside",dismissButtonTestId:r,getRootRef:B,usePortal:S,...d})=>{const y=i.useId(),b=`vkui-alert-${y}-title`,M=`vkui-alert-${y}-description`,D=w(),{isDesktop:R}=gt(),[n,m]=i.useState(!1),_=i.useRef(V),[H,p]=bt(n?"exit":"enter",{onExited(){_.current(),_.current=V,x()}}),I=R&&D!=="ios",et=i.useRef(null),A=i.useCallback(()=>{m(!0)},[]),st=i.useCallback(ot=>{const{action:$,autoCloseDisabled:nt=!1}=ot;nt?$&&$({close:A}):($&&(_.current=$),m(!0))},[A]);return at(),t.jsx(it,{usePortal:S,children:t.jsx(ct,{className:c,closing:n,style:u,onClick:A,getRootRef:B,children:t.jsxs(ht,{...d,...p,getRootRef:et,onClick:lt,onClose:A,autoFocus:H==="entered",className:k(o.host,D==="ios"&&o.ios,D==="vkcom"&&o.vkcom,n?o.closing:o.opening,R&&o.desktop),role:"alertdialog","aria-modal":!0,"aria-labelledby":b,"aria-describedby":M,children:[t.jsxs("div",{className:k(o.content,v==="inside"&&o.contentWithButton),children:[q(g)&&t.jsx(se,{id:b,children:g}),q(h)&&t.jsx(oe,{id:M,children:h}),a,I&&v==="inside"&&t.jsx(xt,{label:f,className:k(o.dismiss,"vkuiInternalAlert__dismiss"),onClick:A,hoverMode:"opacity",activeMode:"opacity","data-testid":r,children:t.jsx(_t,{})})]}),t.jsx(ee,{actions:e,actionsAlign:l,actionsLayout:s,renderAction:C,onItemClick:st}),I&&v==="outside"&&t.jsx(ft,{onClick:A,"data-testid":r,children:f})]})})})},re={light:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"black"}},dark:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"white"}}},ae=({value:e,status:s})=>t.jsx("span",{style:re[O.theme][s],children:e}),X=e=>{const s=e.split("").map(a=>({value:a,status:"default"}));return s[0].status="current",s},ie={ru:/^[ЁёА-я\s]/,en:/^[a-zA-Z\s]/},tt=(e,s)=>e.date<s.date?1:-1,U=(e,s)=>{const[a,c]=[e.cpm/e.errors,s.cpm/s.errors];return a>c?-1:a<c?1:e.cpm>s.cpm?-1:e.cpm<s.cpm?1:0};class E{static load(){return Z.utils.storage.speedtype.history.slice()}static save(s){s.length>100&&(s.sort(tt),s=s.slice(0,100)),Z.utils.storage.speedtype.history=s}}const ce=()=>{const[e,s]=i.useState(),[a,c]=i.useState(0),[u,g]=i.useState(0),[h,x]=i.useState(0),[f,C]=i.useState(!1),[l,v]=i.useState(E.load()),{t:r,i18n:B}=vt("translation",{keyPrefix:"pages.utils.list.speedtype"}),S=r("text"),[d,y]=i.useState(X(S)),b=n=>t.jsx(kt,{mode:"outline",style:{textAlign:"center"},children:t.jsxs(yt,{hasActive:!1,hasHover:!1,subtitle:B.t(`languages.${n.lang}`),extraSubtitle:St(n.date).format("DD.MM.YYYY, HH:mm:ss"),children:[t.jsxs(N,{before:n.cpm<200?t.jsx(K,{}):n.cpm<400?t.jsx(J,{}):t.jsx(Q,{}),textWrap:"short",children:[r("cpm"),": ",n.cpm]}),t.jsxs(N,{before:t.jsx(G,{fill:`rgb(${150+n.errors}, ${162-n.errors*8.1}, ${173-n.errors*8.65})`}),textWrap:"short",children:[r("errors"),": ",n.errors]})]})}),M=()=>{c(0),g(0),x(0),y(X(S))},D=n=>{if(!ie[O.language].test(n)){F.popout=t.jsx(ne,{actions:[{title:r("continue"),mode:"default"}],description:r("switchLayout"),onClose:()=>{F.popout=null}});return}const m=d.findIndex(p=>p.status==="current"||p.status==="invalid"),_=d[m];m===0&&_.status==="current"&&s(Date.now());debugger;const H=()=>{let p=Math.floor(60/((Date.now()-e)/1e3/m));return isNaN(p)&&(p=0),p};if(n===_.value)if(_.status="valid",m+1===d.length){y([]),x(m/(d.length/100));const p=H();c(p);const I=[...l,{lang:O.language,cpm:p,errors:u,date:e}];v(I),E.save(I),C(!1);return}else d[m+1].status="current";else _.status="invalid",g(u+1);x(m/(d.length/100)),c(H()),y([...d])},R=n=>{n.preventDefault(),(f||n.key===S[0])&&(C(!0),D(n.key))};return i.useEffect(()=>(document.addEventListener("keypress",R),()=>{document.removeEventListener("keypress",R)}),[a,e,u,l,h,f]),t.jsxs(j,{children:[d.length>0&&t.jsxs(Y,{onClick:()=>{var n;(n=document.getElementById("input"))==null||n.focus()},children:[t.jsx(wt,{value:h}),t.jsx(W,{size:28}),t.jsx("div",{style:{textAlign:"center"},children:d.map(ae)})]}),t.jsxs(j,{mode:"plain",header:t.jsx(L,{children:r("results")}),children:[t.jsxs(N,{before:a<200?t.jsx(K,{}):a<400?t.jsx(J,{}):t.jsx(Q,{}),textWrap:"short",children:[r("cpm"),": ",a]}),t.jsxs(N,{before:t.jsx(G,{fill:`rgb(${150+u}, ${162-u*8.1}, ${173-u*8.65})`}),textWrap:"short",children:[r("errors"),": ",u]}),d.length===0&&t.jsx(Y,{style:{display:"flex",justifyContent:"center"},children:t.jsx(P,{appearance:"positive",stretched:!0,size:"l",onClick:M,children:r("restart")})})]}),l.length>0&&t.jsxs(j,{mode:"plain",children:[t.jsx(j,{separator:"hide",mode:"plain",style:{textAlign:"center"},description:`${r("formula")}: ${r("cpm")} / ${r("errors")}`,children:t.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"center"},children:[t.jsxs(j,{style:{marginRight:l.length>1?"5px":void 0},separator:"hide",mode:"plain",children:[t.jsx(L,{children:r("bestResult")}),b(l.sort(U)[0])]}),l.length>1&&t.jsxs(j,{style:{marginLeft:"5px"},separator:"hide",mode:"plain",children:[t.jsx(L,{children:r("worstResult")}),b(l.sort(U)[l.length-1])]})]})}),t.jsx(W,{}),t.jsx(j,{mode:"plain",header:t.jsx(L,{after:`${r("total")}: ${l.length}`,children:r("history")}),children:t.jsx(At,{padding:!0,children:l.sort(tt).map(b)})}),t.jsx(W,{}),t.jsx(jt,{}),t.jsx(Ct,{hasActive:!1,hasHover:!1,children:t.jsx(P,{size:"m",mode:"primary",appearance:"negative",onClick:()=>{v([]),E.save([]),M()},children:r("clearHistory")})})]})]})},xe=dt(ce);export{xe as default};
