import{_ as P,j as e,S as W,b as V,d as y,e as A,V as de,g as k,r as h,aj as ue,n as Y,x as Z,aT as he,az as pe,au as fe,aU as xe,aI as me,aJ as O,aK as J}from"./index-DXObVkYb.js";import{Y as ge,Z as ne,f as _e,B as T,_ as G,$ as je,J as ve,u as ye,a0 as be,I as Ae,a as Ce,G as b,D as K,e as q,H as L,a1 as ke,i as we,s as Q,R as Se}from"./index-Dydb4pI3.js";import{u as Me}from"./useCSSKeyframesAnimationController-C-DYMe_G.js";import{C as Re,a as De}from"./CardScroll-CBFOg5My.js";import{P as Ie}from"./Progress-CGABg9El.js";import{M as z}from"./MiniInfoCell-BlthkcLE.js";import{h as Be}from"./moment-C5S46NFB.js";const U=t=>{var{width:s=28,height:o=28,viewBox:n="0 0 28 28",children:c,style:l,fill:i}=t,u=P(t,["width","height","viewBox","children","style","fill"]);return e.jsxs(W,V(y({baseClassName:"vkuiIcon--error_circle_outline_28",viewBox:n,width:s,height:o,style:i?y({color:i},l):l,fill:"none"},u),{children:[c,e.jsx("path",{fill:"currentColor",d:"M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 2C8.477 4 4 8.477 4 14s4.477 10 10 10 10-4.477 10-10S19.523 4 14 4m0 13.6a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8m.074-9.6c.237 0 .386.037.517.107q.196.106.302.302c.07.13.107.28.107.517v6.148c0 .237-.037.386-.107.517a.73.73 0 0 1-.302.302c-.13.07-.28.107-.517.107h-.148c-.237 0-.386-.037-.517-.107a.73.73 0 0 1-.302-.302c-.07-.13-.107-.28-.107-.517V8.926c0-.237.037-.386.107-.517a.73.73 0 0 1 .302-.302c.13-.07.28-.107.517-.107z"})]}))},X=t=>{var{width:s=28,height:o=28,viewBox:n="0 0 28 28",children:c,style:l,fill:i}=t,u=P(t,["width","height","viewBox","children","style","fill"]);return e.jsxs(W,V(y({baseClassName:"vkuiIcon--speedometer_max_outline_28",viewBox:n,width:s,height:o,style:i?y({color:i},l):l,fill:"none"},u),{children:[c,e.jsx("path",{fill:"currentColor",d:"M14 2c1.687 0 3.294.348 4.751.978l.328.147a12 12 0 0 1 3.406 2.39A11.97 11.97 0 0 1 26 14q0 .638-.065 1.26a1 1 0 0 1-1.99-.208Q24 14.534 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.112-2.115l-.005-.002A10 10 0 0 0 14 4a9.96 9.96 0 0 0-4.7 1.17l-.066.036A10 10 0 0 0 6.93 6.93 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.74-2.54l.006-.002A12 12 0 0 1 14 2"}),e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"m16.077 11.8 8.905 7.247c1 .813.084 2.4-1.12 1.94L13.131 16.9a3 3 0 0 1-.318-.143 3 3 0 1 1 2.979-5.162q.146.093.284.205M14.5 13.133a1 1 0 1 0-1 1.732 1 1 0 0 0 1-1.732",clipRule:"evenodd"})]}))},ee=t=>{var{width:s=28,height:o=28,viewBox:n="0 0 28 28",children:c,style:l,fill:i}=t,u=P(t,["width","height","viewBox","children","style","fill"]);return e.jsxs(W,V(y({baseClassName:"vkuiIcon--speedometer_middle_outline_28",viewBox:n,width:s,height:o,style:i?y({color:i},l):l,fill:"currentColor"},u),{children:[c,e.jsx("path",{fillRule:"evenodd",d:"M16.944 13.302 15.121 1.966c-.205-1.273-2.037-1.273-2.242 0l-1.823 11.336a3 3 0 0 0-.036.347 3 3 0 1 0 5.96.001 3 3 0 0 0-.036-.348M15 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0",clipRule:"evenodd"}),e.jsx("path",{d:"M17.431 3.498a1 1 0 0 1 1.314-.523 12 12 0 0 1 3.74 2.54A11.97 11.97 0 0 1 26 14c0 2.413-.713 4.663-1.941 6.546a1 1 0 1 1-1.676-1.092A9.95 9.95 0 0 0 24 14a9.97 9.97 0 0 0-2.929-7.071 10 10 0 0 0-3.117-2.117 1 1 0 0 1-.523-1.314m-6.868.002a1 1 0 0 1-.522 1.314A10 10 0 0 0 6.93 6.929 9.97 9.97 0 0 0 4 14c0 2.014.594 3.886 1.617 5.454a1 1 0 1 1-1.676 1.092A11.95 11.95 0 0 1 2 14c0-3.313 1.344-6.315 3.515-8.485a12 12 0 0 1 3.734-2.537 1 1 0 0 1 1.314.521Z"})]}))},te=t=>{var{width:s=28,height:o=28,viewBox:n="0 0 28 28",children:c,style:l,fill:i}=t,u=P(t,["width","height","viewBox","children","style","fill"]);return e.jsxs(W,V(y({baseClassName:"vkuiIcon--speedometer_start_outline_28",viewBox:n,width:s,height:o,style:i?y({color:i},l):l,fill:"currentColor"},u),{children:[c,e.jsx("path",{d:"M14 2c-1.687 0-3.293.348-4.751.978l-.328.147a12 12 0 0 0-3.406 2.39A11.97 11.97 0 0 0 2 14q0 .638.065 1.26a1 1 0 0 0 1.99-.208A10 10 0 0 1 4 14a9.97 9.97 0 0 1 2.929-7.071 10 10 0 0 1 3.112-2.115l.005-.002A10 10 0 0 1 14 4a9.96 9.96 0 0 1 4.7 1.17l.066.036c.85.462 1.626 1.044 2.305 1.723A9.97 9.97 0 0 1 24 14a9.95 9.95 0 0 1-1.617 5.454 1 1 0 1 0 1.676 1.092A11.95 11.95 0 0 0 26 14c0-3.313-1.344-6.315-3.515-8.485a12 12 0 0 0-3.74-2.54l-.006-.002A12 12 0 0 0 14 2"}),e.jsx("path",{fillRule:"evenodd",d:"m11.923 11.8-8.905 7.247c-1 .813-.084 2.4 1.12 1.94l10.73-4.088q.165-.063.318-.143a3 3 0 1 0-2.979-5.162q-.146.093-.284.205Zm1.577 1.334a1 1 0 1 1 1 1.732 1 1 0 0 1-1-1.732",clipRule:"evenodd"})]}))},Ne="_host_sxbvb_1",$e={host:Ne},He=({children:t="Закрыть",className:s,...o})=>e.jsxs(ge,{className:A($e.host,s),...o,children:[t&&e.jsx(de,{children:t}),e.jsx(ne,{})]}),Le="_host_1tfeg_1",ze="_desktop_1tfeg_17",Pe="_opening_1tfeg_21",We="_closing_1tfeg_26",Ve="_content_1tfeg_43",Ee="_contentWithButton_1tfeg_49",qe="_action_1tfeg_54",Fe="_actions_1tfeg_59",Oe="_title_1tfeg_67",Te="_description_1tfeg_72",Ye="_actionsDirectionHorizontal_1tfeg_81",Ze="_actionsDirectionVertical_1tfeg_85",Je="_actionsAlignLeft_1tfeg_96",Ge="_actionsAlignCenter_1tfeg_101",Ke="_actionsAlignRight_1tfeg_106",Qe="_ios_1tfeg_115",Ue="_actionModeCancel_1tfeg_254",Xe="_actionModeDestructive_1tfeg_258",et="_vkcom_1tfeg_266",tt="_button_1tfeg_283",st="_buttonModeCancel_1tfeg_287",ot="_dismiss_1tfeg_291",r={host:Le,desktop:ze,opening:Pe,closing:We,content:Ve,contentWithButton:Ee,action:qe,actions:Fe,title:Oe,description:Te,actionsDirectionHorizontal:Ye,actionsDirectionVertical:Ze,actionsAlignLeft:Je,actionsAlignCenter:Ge,actionsAlignRight:Ke,ios:Qe,actionModeCancel:Ue,actionModeDestructive:Xe,vkcom:et,button:tt,buttonModeCancel:st,dismiss:ot},nt=({mode:t,...s})=>e.jsx(_e,{Component:s.href?"a":"button",baseClassName:A(r.action,t==="destructive"&&r.actionModeDestructive,t==="cancel"&&r.actionModeCancel),...s}),rt=({mode:t,...s})=>{const o=k();let n="tertiary";return o==="vkcom"&&(n=t==="cancel"?"secondary":"primary"),e.jsx(T,{className:A(r.button,t==="cancel"&&r.buttonModeCancel),mode:n,size:"m",...s})},it=t=>k()==="ios"?e.jsx(nt,{...t}):e.jsx(rt,{...t}),at={left:r.actionsAlignLeft,center:r.actionsAlignCenter,right:r.actionsAlignRight},ct={vertical:r.actionsDirectionVertical,horizontal:r.actionsDirectionHorizontal},lt=({actions:t=[],renderAction:s=l=>e.jsx(it,{...l}),onItemClick:o,actionsAlign:n,actionsLayout:c})=>{const i=k()==="vkcom"?"horizontal":c;return e.jsx("div",{className:A(r.actions,n&&at[n],i&&ct[i]),children:t.map((u,C)=>{const{title:_,action:p,autoCloseDisabled:j,...d}=u;return e.jsx(h.Fragment,{children:s({children:_,onClick:()=>o(u),...d})},C)})})},dt=t=>{switch(k()){case"ios":return e.jsx(G,{className:r.title,weight:"1",level:"3",...t});default:return e.jsx(G,{className:r.title,weight:"2",level:"2",...t})}},ut=t=>{switch(k()){case"vkcom":return e.jsx(ue,{className:r.description,...t});case"ios":return e.jsx(ve,{className:r.description,...t});default:return e.jsx(je,{Component:"span",className:r.description,weight:"3",...t})}},ht=({actions:t,actionsLayout:s="horizontal",children:o,title:n,description:c,onClose:l,dismissLabel:i="Закрыть предупреждение",renderAction:u,actionsAlign:C,dismissButtonMode:_="outside",dismissButtonTestId:p,onClick:j,allowClickPropagation:d=!1,titleTestId:E,descriptionTestId:w,closing:f,setClosing:x,...S})=>{const M=h.useId(),B=`vkui-alert-${M}-title`,R=`vkui-alert-${M}-description`,a=k(),{isDesktop:g}=ye(),v=h.useRef(Y),[N,m]=Me(f?"exit":"enter",{onExited(){v.current(),v.current=Y,l()}}),D=g&&a!=="ios",ie=h.useRef(null),I=h.useCallback(()=>{x==null||x(!0)},[x]),ae=h.useCallback($=>{const{action:H,autoCloseDisabled:le=!1}=$;le?H&&H({close:I}):(H&&(v.current=H),x==null||x(!0))},[I,x]),ce=d?j:$=>{he($),j==null||j($)};return e.jsxs(be,{...m,onClick:ce,getRootRef:ie,onClose:I,autoFocus:N==="entered",className:A(r.host,a==="ios"&&r.ios,a==="vkcom"&&r.vkcom,f?r.closing:r.opening,g&&r.desktop),role:"alertdialog","aria-modal":!0,"aria-labelledby":B,"aria-describedby":R,...S,children:[e.jsxs("div",{className:A(r.content,_==="inside"&&r.contentWithButton),children:[Z(n)&&e.jsx(dt,{"data-testid":E,id:B,children:n}),Z(c)&&e.jsx(ut,{"data-testid":w,id:R,children:c}),o,D&&_==="inside"&&e.jsx(Ae,{label:i,className:A(r.dismiss,"vkuiInternalAlert__dismiss"),onClick:I,hoverMode:"opacity",activeMode:"opacity","data-testid":p,children:e.jsx(ne,{})})]}),D&&_==="outside"&&e.jsx(He,{onClick:I,"data-testid":p,children:i}),e.jsx(lt,{actions:t,actionsAlign:C,actionsLayout:s,renderAction:u,onItemClick:ae})]})},pt=({usePortal:t,style:s,className:o,getRootRef:n,...c})=>{const[l,i]=h.useState(!1),u=h.useCallback(()=>{i(!0)},[]);return pe(),e.jsx(fe,{usePortal:t,children:e.jsx(xe,{className:o,closing:l,style:s,onClick:u,getRootRef:n,strategy:"fixed",children:e.jsx(ht,{...c,closing:l,setClosing:i})})})},ft={light:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"black"}},dark:{current:{backgroundColor:"green",color:"white",padding:"3px",borderRadius:"3px"},invalid:{backgroundColor:"red",color:"white",padding:"3px",borderRadius:"3px"},valid:{color:"green"},default:{color:"white"}}},xt=({value:t,status:s})=>e.jsx("span",{style:ft[O.theme][s],children:t}),se=t=>{const s=t.split("").map(o=>({value:o,status:"default"}));return s[0].status="current",s},mt={ru:/^[ЁёА-я\s]/,en:/^[a-zA-Z\s]/},re=(t,s)=>t.date<s.date?1:-1,oe=(t,s)=>{const[o,n]=[t.cpm/t.errors,s.cpm/s.errors];return o>n?-1:o<n?1:t.cpm>s.cpm?-1:t.cpm<s.cpm?1:0};class F{static load(){return Q.utils.storage.speedtype.history.slice()}static save(s){s.length>100&&(s.sort(re),s=s.slice(0,100)),Q.utils.storage.speedtype.history=s}}const gt=()=>{const[t,s]=h.useState(),[o,n]=h.useState(0),[c,l]=h.useState(0),[i,u]=h.useState(0),[C,_]=h.useState(!1),[p,j]=h.useState(F.load()),{t:d,i18n:E}=Ce("translation",{keyPrefix:"pages.utils.list.speedtype"}),w=d("text"),[f,x]=h.useState(se(w)),S=a=>e.jsx(De,{mode:"outline",style:{textAlign:"center"},children:e.jsxs(Se,{hasActive:!1,hasHover:!1,subtitle:E.t(`languages.${a.lang}`),extraSubtitle:Be(a.date).format("DD.MM.YYYY, HH:mm:ss"),children:[e.jsxs(z,{before:a.cpm<200?e.jsx(te,{}):a.cpm<400?e.jsx(ee,{}):e.jsx(X,{}),textWrap:"short",children:[d("cpm"),": ",a.cpm]}),e.jsxs(z,{before:e.jsx(U,{fill:`rgb(${150+a.errors}, ${162-a.errors*8.1}, ${173-a.errors*8.65})`}),textWrap:"short",children:[d("errors"),": ",a.errors]})]})}),M=()=>{n(0),l(0),u(0),x(se(w))},B=a=>{if(!mt[O.language].test(a)){J.popout=e.jsx(pt,{actions:[{title:d("continue"),mode:"default"}],description:d("switchLayout"),onClose:()=>{J.popout=null}});return}const g=f.findIndex(m=>m.status==="current"||m.status==="invalid"),v=f[g];g===0&&v.status==="current"&&s(Date.now());debugger;const N=()=>{let m=Math.floor(60/((Date.now()-t)/1e3/g));return isNaN(m)&&(m=0),m};if(a===v.value)if(v.status="valid",g+1===f.length){x([]),u(g/(f.length/100));const m=N();n(m);const D=[...p,{lang:O.language,cpm:m,errors:c,date:t}];j(D),F.save(D),_(!1);return}else f[g+1].status="current";else v.status="invalid",l(c+1);u(g/(f.length/100)),n(N()),x([...f])},R=a=>{a.preventDefault(),(C||a.key===w[0])&&(_(!0),B(a.key))};return h.useEffect(()=>(document.addEventListener("keypress",R),()=>{document.removeEventListener("keypress",R)}),[o,t,c,p,i,C]),e.jsxs(b,{children:[f.length>0&&e.jsxs(K,{onClick:()=>{var a;(a=document.getElementById("input"))==null||a.focus()},children:[e.jsx(Ie,{value:i}),e.jsx(q,{size:28}),e.jsx("div",{style:{textAlign:"center"},children:f.map(xt)})]}),e.jsxs(b,{mode:"plain",header:e.jsx(L,{children:d("results")}),children:[e.jsxs(z,{before:o<200?e.jsx(te,{}):o<400?e.jsx(ee,{}):e.jsx(X,{}),textWrap:"short",children:[d("cpm"),": ",o]}),e.jsxs(z,{before:e.jsx(U,{fill:`rgb(${150+c}, ${162-c*8.1}, ${173-c*8.65})`}),textWrap:"short",children:[d("errors"),": ",c]}),f.length===0&&e.jsx(K,{style:{display:"flex",justifyContent:"center"},children:e.jsx(T,{appearance:"positive",stretched:!0,size:"l",onClick:M,children:d("restart")})})]}),p.length>0&&e.jsxs(b,{mode:"plain",children:[e.jsx(b,{separator:"hide",mode:"plain",style:{textAlign:"center"},description:`${d("formula")}: ${d("cpm")} / ${d("errors")}`,children:e.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"center"},children:[e.jsxs(b,{style:{marginRight:p.length>1?"5px":void 0},separator:"hide",mode:"plain",children:[e.jsx(L,{children:d("bestResult")}),S(p.sort(oe)[0])]}),p.length>1&&e.jsxs(b,{style:{marginLeft:"5px"},separator:"hide",mode:"plain",children:[e.jsx(L,{children:d("worstResult")}),S(p.sort(oe)[p.length-1])]})]})}),e.jsx(q,{}),e.jsx(b,{mode:"plain",header:e.jsx(L,{after:`${d("total")}: ${p.length}`,children:d("history")}),children:e.jsx(Re,{padding:!0,children:p.sort(re).map(S)})}),e.jsx(q,{}),e.jsx(ke,{}),e.jsx(we,{hasActive:!1,hasHover:!1,children:e.jsx(T,{size:"m",mode:"primary",appearance:"negative",onClick:()=>{j([]),F.save([]),M()},children:d("clearHistory")})})]})]})},kt=me(gt);export{kt as default};
